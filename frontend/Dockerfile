FROM node:slim

ARG BACKEND_PORT=9000
ARG FRONTEND_PORT=5000

WORKDIR /usr/src/app
COPY package*.json ./
RUN npm install

COPY . .

ENV BACKEND_PORT=${BACKEND_PORT}
ENV FRONTEND_PORT=${BACKEND_PORT}
ENV NODE_ENV=production

RUN npm run build

EXPOSE ${FRONTEND_PORT}

CMD npm run serve